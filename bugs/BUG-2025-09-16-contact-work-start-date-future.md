# BUG-2025-09-16 — Контакт → Работа и доходы: сохраняются нереалистичные даты начала работы (например, 2201 год)

**Project:** CRM  
**Компонент/Модуль:** Контакты → Карточка контакта → Доп. информация → Работа и доходы  
**Экран/URL/Маршрут:** ``  
**Пример:** https://crm-test.ru
**Reporter:** Юлия  
**Окружение:** stage (`crm-test`), актуально на 2025-09-16  
**Сборка/Версия:** v.56e46cf9
**Устройство/ОС/Браузер/Разрешение:** Windows 11, Chrome 140, 1920×1080  
**Роль пользователя:** Админ  
**Повторяемость:** всегда  
**Частота:** 5/5

## Шаги для воспроизведения
1. Открыть карточку контакта.  
2. Перейти во вкладку **Доп. информация** → блок **Работа и доходы**.  
3. Ввести `01.01.2201` в поля:  
   - **Дата начала работы (общий стаж)**  
   - **Дата начала работы на послед. месте работы**  
4. Нажать **Сохранить**.

## Ожидаемый результат
- Дата не может быть в будущем/вне разумного диапазона.  
- Поля подсвечены, показано понятное сообщение об ошибке.  
- Сохранение блокируется до исправления значений.

## Фактический результат
- Значения с годом **2201** принимаются/сохраняются без ошибок.

## Скриншоты/Видео/HAR/Логи
- Скриншот: `bugs/assets/Снимок экрана 2025-09-16 171320.png`

## Доп. детали
- **Предполагаемая причина:** отсутствует проверка верхней границы даты (maxDate) на фронте и/или серверная валидация; допускается сохранение будущих дат.  
- **Риски:** некорректная аналитика стажа, отчётов и воронок; дальнейшие вычисления на основе стажа/дат будут искажены.  
- **Связанные области для регресса:** все поля дат в карточке контакта, импорты/массовое обновление, локализация формата даты (RU), часовые пояса.

## Acceptance для фикса (кратко)
- В обоих полях дат запрещён ввод дат позже «сегодня» (по часовому поясу сервера/клиента — согласовать), показывается человеко-читаемая ошибка.  
- Разумная нижняя граница — по договорённости (например, `01.01.1900`) — единообразно на фронте и бэке.  
- При попытке сохранить будущую дату API отвечает 4xx с кодом/сообщением валидации; UI не отправляет повторный запрос и сохраняет фокус на поле.  
- Пограничные проверки:  
  - **Сегодня** — допустимо; **завтра** — запрещено.  
  - Большие даты (например, `31.12.2099`) — запрещено.  
  - Леап-кейс: `29.02.2024` — ок; `29.02.2023` — отклонить с понятным текстом.  
- Нет ошибок в консоли/сети, состояние формы корректно обновляется.  
- Миграция/скрипт очистки (при необходимости): выявить уже сохранённые некорректные даты и привести/обнулить по правилам продукта.

## SQL/API (пригодится разработчику)
- Эндпоинт обновления карточки контакта (PATCH/PUT для полей работы и стажа) — добавить серверную валидацию `date <= today`, нижняя граница — по спецификации.  
- Единый валидатор дат переиспользуется всеми полями блока «Работа и доходы».

